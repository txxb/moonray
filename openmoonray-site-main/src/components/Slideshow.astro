---
const { slides = [] } = Astro.props;
---

<div class="max-w-xl mx-auto">
  <div id="slideshow">
    {slides.map((slide, index) => (
      <div
        class={`slide ${index === 0 ? "block" : "hidden"}`}
        data-index={index}
      >
        <h2 class="text-2xl font-bold mb-3">{slide.title}</h2>

        <div class="relative h-[400px] mb-4 flex items-center justify-center">
          <img
            src={slide.image}
            alt={slide.title}
            class="w-full h-full object-contain rounded"
          />
        </div>

        <p class="text-gray-700">{slide.description}</p>
      </div>
    ))}

    <div class="flex justify-between mt-6">
      <button
        id="prev"
        class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded shadow"
      >
        Previous
      </button>
      <button
        id="next"
        class="px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded shadow"
      >
        Next
      </button>
    </div>
  </div>
</div>

<script type="module" client:load>
  const slides = document.querySelectorAll(".slide");
  let current = 0;
  const intervalTime = 3000
  let autoScroll;

  function showSlide(index) {
    slides[current].classList.add("hidden");
    slides[current].classList.remove("block");

    current = (index + slides.length) % slides.length;

    slides[current].classList.remove("hidden");
    slides[current].classList.add("block");
  }

  document.getElementById("next").onclick = () => {
    showSlide(current + 1);
    resetAutoScroll();
  };

  document.getElementById("prev").onclick = () => {
    showSlide(current - 1);
    resetAutoScroll();
  };

  function startAutoScroll() {
    autoScroll = setInterval(() => {
      showSlide(current + 1);
    }, intervalTime);
  }

  function resetAutoScroll() {
    clearInterval(autoScroll);
    startAutoScroll();
  }

  startAutoScroll();
</script>